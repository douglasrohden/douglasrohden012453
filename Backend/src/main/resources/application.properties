spring.application.name=backend

spring.datasource.url=${SPRING_DATASOURCE_URL:jdbc:postgresql://localhost:5433/artistsdb}
spring.datasource.username=${POSTGRES_USER:postgres}
spring.datasource.password=${POSTGRES_PASSWORD:postgres}
spring.datasource.driver-class-name=org.postgresql.Driver

# Flyway
spring.flyway.enabled=true
spring.flyway.locations=classpath:db/migration
spring.flyway.baseline-on-migrate=true
spring.flyway.baseline-version=0
# Disable validation on migrate to fix checksum mismatch issues
spring.flyway.validate-on-migrate=false
spring.flyway.clean-disabled=true

# Actuator - Health Checks & Liveness/Readiness Probes
management.endpoints.web.exposure.include=health,info,mappings,metrics,prometheus
management.endpoint.health.probes.enabled=true
management.endpoint.health.show-details=always
management.endpoint.health.show-components=always

# Kubernetes Liveness & Readiness probe groups
management.endpoint.health.group.liveness.include=livenessState
management.endpoint.health.group.liveness.show-details=always
management.endpoint.health.group.readiness.include=readinessState,db
management.endpoint.health.group.readiness.show-details=always

# Enable disk space indicator
management.health.diskspace.enabled=true
# Enable database health indicator
management.health.db.enabled=true
# Disable mail health indicator to avoid actuator trying SMTP connection
management.health.mail.enabled=false

# Prevent Spring Boot from auto-configuring a MailSender (avoids SMTP auth at startup)
spring.autoconfigure.exclude=org.springframework.boot.autoconfigure.mail.MailSenderAutoConfiguration

# JWT Configuration
# Secret key must be at least 256 bits (32 bytes)
# generate one using: openssl rand -base64 32
jwt.secret=404E635266556A586E3272357538782F413F4428472B4B6250645367566B5970
# 5 minutes in milliseconds
jwt.expiration=300000
# 7 days in milliseconds
jwt.refresh.expiration=604800000

# Enable debug logging for CORS and security during development
# Set Spring Security to INFO to avoid verbose DEBUG entries like 
# "Securing GET /error" appearing in logs.
logging.level.org.springframework.web.filter.CorsFilter=DEBUG
logging.level.org.springframework.security=INFO

server.port=3001

server.error.include-message=always
server.error.include-binding-errors=always

spring.jpa.show-sql=true

# Logging - Stack traces mais curtos
logging.level.root=WARN
logging.level.com.douglasrohden=INFO
logging.level.org.hibernate=WARN
logging.level.org.springframework.web=ERROR
logging.level.org.apache.catalina=ERROR

# Limitar profundidade do stack trace (mostra apenas 5 linhas)
server.error.include-stacktrace=never
logging.exception-conversion-word=%wEx{short}